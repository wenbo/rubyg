require 'bigdecimal'
def to_bin(float, n)
  (1..n).map{|i| (2**(-i)).to_f }.inject([BigDecimal(float),"0."]){|(x,s),y|
    if x>=y then [x-y, s << "1"] else [x, s << "0"] end
  }[1]
end
to_bin "0.1", 50      # => "0.00011001100110011001100110011001100110011001100110"
to_bin "0.3", 50      # => "0.01001100110011001100110011001100110011001100110011"
to_bin "0.5", 10      # => "0.1000000000"
to_bin "0.625", 10    # => "0.1010000000"
